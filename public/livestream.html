<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Chatroll Sample App</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <header class="py-4 mb-2">
        <img src="./assets/soypro.jpg" alt="Soypro logo" width="74px" />
    </header>

    <div class="row">
        <!-- Player Column -->
        <div class="col-md-8 mb-2">
            <div class="player">
                <div itemscope itemtype="https://schema.org/VideoObject">
                    <meta itemprop="name" content="Prova_DR"/>
                    <meta itemprop="description" content="Prova_DR"/>
                    <meta itemprop="uploadDate" content="2024-01-25T11:00:05.000Z"/>
                    <meta itemprop="thumbnailUrl" content="https://s2.dmcdn.net/l/VdGIX1bia3o6L8RUm/x240"/>
                    <meta itemprop="embedUrl" content="https://geo.dailymotion.com/player/xq5a8.html?video=x8rryxt"/>
                    <script src="https://geo.dailymotion.com/player/xq5a8.js" data-video="x8rryxt"></script>
                    <script>
                        var noLive = false;
                        dailymotion
                            .getPlayer()
                            .then( async (player) => {
                                // const state = await player.getState();
                                // console.log('Player state: ', state);

                                player.on(dailymotion.events.PLAYER_ERROR, e => {
                                    if (e.playerError.code === "DM003") {
                                        console.log(e.playerError.title);
                                        noLive = true;
                                    }
                                })

                                player.on(dailymotion.events.PLAYER_CRITICALPATHREADY, _ => {
                                    if (noLive === false) {
                                        var iframe = document.createElement('iframe');
                                        iframe.src = 'https://chatroll.com/embed/chat/a-test-event-for-development?id=8yCPU_o9WfM&platform=html'; // URL of the content you want to load
                                        iframe.width = '100%'; // Set the width
                                        iframe.height = '500px'; // Set the height
                                        iframe.frameBorder = '0'; // Remove border
                                        iframe.scrolling = 'no';
                                        iframe.allotransparency = 'true';
                                        document.querySelector('.chat').appendChild(iframe);
                                    } else {
                                        document.querySelector('.chat').innerText = 'Live stream isn\'t available';
                                    }
                                });
                            })
                            .catch((e) => console.error(e));

                    </script>
                </div>
            </div>
        </div>

        <!-- Chat Column -->
        <aside class="col-md-4">
            <div class="chat">
                <h2 class="fs-5 fw-semibold">Chat</h2>
            </div>
        </aside>
    </div>
</div>
</body>
</html>